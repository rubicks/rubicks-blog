---
layout: post
title: hakyll
category: posts
---
I got [hakyll](hakyll) working.

```
$ ghc --make site.hs && ./site build
```

At least, I think I got hakyll working.

Update: I haven't got it working yet. Getting [hakyll](hakyll),
[travis-ci](travis-ci), and [github-pages](github-pages) to work together
is... not difficult, but not trivial, either.

When using hakyll, the working process is as follows:

```
$ emacs -nw ./stuff.md    # hack on templates and markdown files
$ ghc --make site.hs      # create ./site executable
$ ./site build            # create site artifacts in ./_site/
```

From there, getting the contents of ```./_site/``` into your github-pages repo
is usually left as an exercise to the reader.

Let's automate it.

The idea is to keep two repos: one repo for all the hakyll stuff; another for
the github-pages stuff. Every commit to the hakyll repo should be built by
Travis. On build failure, Travis notifies me. On success, Travis commits the
contents of the ```/_site/``` directory to the github-pages repo.


There's something wrong with the way [travis](travis-rubicks-blog) is handling my
[.gitmodules](rubicks-blog-gitmodules).

I usually ```git clone``` my repos from "pushable" URLs; i.e.,

```
git@github.com:username/reponame.git
```

To manipulate pushable repos, one needs to setup ssh keys---generate the key
pair, put the pubkey on github, provide the privkey during authentication. The
operative word here is "manipulate". Any manipulation of the repository via
these URLs (noteably including ```git clone```) requires the manipulator to
utilize a suitable privkey.

If travis has no such key pair, then it can't clone the submodule.


[hakyll]: jaspervdj.be/hakyll
[travis-rubicks-blog]: travis-ci.com/rubicks/rubicks-blog
[rubicks-blog-gitmodules]: https://raw.githubusercontent.com/rubicks/rubicks-blog/master/.gitmodules
[git-submodule]: http://www.git-scm.com/book/en/v2/Git-Tools-Submodules
[github-pages]: https://pages.github.com/
